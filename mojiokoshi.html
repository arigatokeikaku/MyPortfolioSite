<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta viewport="width=device-width, initial-scale=1.0">
    <title>音声テキスト化システム</title>
</head>
<body>
    <h1>音声テキスト化システム</h1>
    <button id="startRecognition">音声認識を開始</button>
    <p>テキスト化した結果: </p>
    <div id="textResult"></div>

    <script>
        SpeechRecognition = window.SpeechRecognition || webkitSpeechRecognition;
        const recognition = new SpeechRecognition();

        recognition.continuous = true; // 連続的な音声認識
        recognition.lang = 'ja-JP'; // 言語を日本語に設定
        recognition.interimResults = true; // 中間結果も取得

        let accumulatedText = "";

        recognition.addEventListener('result', (event) => {
            let currentText = "";
            for (let i = event.resultIndex; i < event.results.length; ++i) {
                currentText += event.results[i][0].transcript;
            }
            accumulatedText += currentText;
            document.getElementById('textResult').textContent = accumulatedText;
        });

        document.getElementById('startRecognition').addEventListener('click', function() {
            recognition.start();
        });

        recognition.addEventListener('end', () => {
            recognition.start(); // 音声認識を再度開始する
        });

        recognition.addEventListener('error', (event) => {
            console.error('音声認識エラー:', event.error);
            recognition.start(); // エラーが発生した場合、再度開始する
        });
    </script>
</body>
</html>
